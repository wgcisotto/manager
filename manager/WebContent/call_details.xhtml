<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://java.sun.com/jsf/html"
      xmlns:b="http://bootsfaces.net/ui"
      xmlns:p="http://primefaces.org/ui"
      xmlns:f="http://java.sun.com/jsf/core"
      xmlns:ui="http://java.sun.com/jsf/facelets">
    <ui:decorate template="default.xhtml">
        <ui:define name="header">
          Chamada Efetuada
        </ui:define>
        <ui:define name="default">
         
         <p:messages id="msgCallDetail" showDetail="true" autoUpdate="true" closable="true" />
         
         <p:panelGrid styleClass="panelgrid_sem_borda" style="width: 100%" columns="1" id="pngControlCallDetails">
         
         <p:dataTable id="dtbCallStudentDetails" widgetVar="dtbCallDetails" var="stud" value="#{student.selectedCallDetails.students_info}" 
                scrollRows="5" scrollable="true" scrollHeight="370"    
                rowKey="#{stud.id_student}" >
                
               <p:column headerText="Foto" >
                <p:graphicImage id="imgStudent" value="#{stud.student.studentImage}" rendered="#{stud.student.studentImage != null}"  style="width:90px;height:90px" />
                <p:graphicImage id="imgStudent2" url="resources/images/shared/unknown.gif" rendered="#{stud.student.studentImage == null}" style="width:90px;height:90px" />
               </p:column>
                
               <p:column headerText="Aluno" >
                <h:outputText value="#{stud.student.student_name}"/>
               </p:column>
           
               <p:column headerText="Status">
                <b:label text="#{stud.status}" severity="warning" rendered="#{stud.status eq 'Ausente'}"/>
                <b:label text="#{stud.status}" severity="Default" rendered="#{stud.status eq 'Presente'}" />    
               </p:column>
               
               <p:column style="width:40px;text-align: center">
                <p:commandButton icon="ui-icon-search" title="Comentarios" styleClass="btn_opcoes" oncomplete="PF('dlgInfo').show();">
                  <f:setPropertyActionListener value="#{stud}" target="#{student.selectedStudentInfo}"/>     
                </p:commandButton>
              </p:column>
                
       
            </p:dataTable>
          </p:panelGrid>
            
            
        <p:remoteCommand id="rmcInfo" name="rmcInfo" update="pngInfo" process="@this"/>
        <p:dialog id="dlgInfo" header="Informações" widgetVar="dlgInfo" minHeight="40" resizable="false" modal="true" onShow="rmcInfo()">
          <p:growl id="growlInfo" sticky="true" showDetail="true" life="3000" severity="error"/>
          <p:panelGrid id="pngInfo"  columns="1" styleClass="panelgrid_sem_borda" >
            <p:inputTextarea value="#{student.selectedStudentInfo.info}" style="width: 800px;height: 200;" />
          </p:panelGrid>
          <f:facet name="footer">
            <p:panelGrid columns="2" style="float: right;" styleClass="panelgrid_sem_borda">
              <h:commandButton styleClass="btn btn-primary" value="Salvar">
                <p:ajax event="click" process="@this pngInfo"  listener="#{student.updateStudentInfo}" update="dtbCallStudentDetails" oncomplete="PF('dlgInfo').hide();"/>
              </h:commandButton>
              <h:commandButton styleClass="btn btn-default" value="Cancelar">
                <f:setPropertyActionListener value="null" target="#{student.selectedStudentInfo}"/> 
                <p:ajax event="click" oncomplete="PF('dlgInfo').hide();" />
              </h:commandButton>
            </p:panelGrid>
          </f:facet>
        </p:dialog>
         

         
        </ui:define>
    </ui:decorate>
</html>