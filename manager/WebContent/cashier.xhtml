<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://java.sun.com/jsf/html"
      xmlns:b="http://bootsfaces.net/ui"
      xmlns:p="http://primefaces.org/ui"
      xmlns:f="http://java.sun.com/jsf/core"
      xmlns:ui="http://java.sun.com/jsf/facelets">
    <ui:decorate template="default.xhtml">
        <ui:define name="header">
          Caixa
        </ui:define>
        <ui:define name="default">
         
         <p:panelGrid columns="1" styleClass="panelgrid_sem_borda">
          
          <h:commandButton styleClass="btn btn-primary btn-lg" value="Venda Rapida">
          </h:commandButton>
          
         
         </p:panelGrid>
        
         <p:panelGrid columns="1" styleClass="panelgrid_sem_borda">
          
          
          <p:dataTable id="dtbCardCash" widgetVar="dtbCard" var="card" value="#{manager.cards}" emptyMessage="Nenhuma Comanda encontrada" 
              selectionMode="single" rowKey="#{card.id_card}">
          
             <p:ajax event="rowSelect" listener="#{manager.onRowSelectCard}" update="@form"/>
             
              <p:column headerText="Id" style="width: 89px;">
                <h:outputText value="#{card.id_card}" />
              </p:column>
       
              <p:column headerText="Status">
                <b:label text="Pendente" severity="warning" rendered="#{card.status eq 'Pendente'}"/>
                <b:badge value="#{card.size}" rendered="#{card.status eq 'Pendente'}"/>
                <b:label text="Fechada" severity="success" rendered="#{card.status eq 'Fechada'}" />
              </p:column>
       
              <p:column headerText="Total">
                  <h:outputText value="#{card.total}" />
              </p:column>
              
              <p:column headerText="Acões" style="width: 89px;">
                <p:commandLink
                  icon="ui-icon-plusthick"
                  onstart="PF('dlgAddProduct').show();">
                  <img src="resources/images/icons/add182.png" width="20" height="20" title="Adicionar Produto"/>
                  <f:setPropertyActionListener value="#{card}" target="#{manager.selectedCardCash}"/>
                </p:commandLink>
	              <p:commandLink
	                icon="ui-icon-cart"
	                onstart="PF('dlgListProdCard').show();">
	                <img src="resources/images/icons/list-1.png" width="20" height="20" title="Produtos"/>
	              </p:commandLink>
                <p:commandLink
                  icon="ui-icon-check"
                  onstart="PF('dlgCloseCard').show();">
                  <img src="resources/images/icons/check52.png" width="20" height="20" title="Fechar comanda"/>
                </p:commandLink>
              </p:column>
          </p:dataTable>
  
  
                    
         </p:panelGrid>
         
         
         
         <p:dialog header="Busca Produto" widgetVar="dlgAddProduct" minHeight="40" resizable="false">
	         <p:panelGrid id="pngFindProTab"  columns="1" styleClass="panelgrid_sem_borda">          
                              
	          <p:dataTable id="dtbProductsCash" widgetVar="dtbProductsCash" var="prd" value="#{manager.products}" emptyMessage="Nenhum Produto encontrado" 
	             filteredValue="#{manager.filteredProducts}">
	     
	              <p:ajax event="rowSelect" listener="#{manager.onRowSelectProduct}" update="@form"/>
	 
	              <f:facet name="header">
	                  <p:outputPanel id="dtbHeader" styleClass="search_align">
	                      <h:outputText value="Search: " />
	                      <p:inputText id="globalFilter" onkeyup="PF('dtbProductsCash').filter()" value="#{manager.globalFilterProduct}" style="width:150px" placeholder="Digite"/>
	                  </p:outputPanel>
	              </f:facet>
	 
	               
	              <p:column headerText="Nome" sortBy="#{prd.name}" filterBy="#{prd.name}" filterMatchMode="contains" >
	                <h:outputText value="#{prd.name}" />
	                <f:facet name="filter">
	                  <h:inputText style="display:none;"/>
	                </f:facet>
	              </p:column>
	       
	       
	              <p:column headerText="Descrição" sortBy="#{prd.description}" >
	                <h:outputText value="#{prd.description}" />
	              </p:column>
	       
	       
	              <p:column headerText="Preço" sortBy="#{prd.price}">
	                <h:outputText value="#{prd.price}">
	                  <f:convertNumber pattern="#,##0.00"/>  
	                </h:outputText>
	              </p:column>
	       
	              <p:column headerText="Quantidade" sortBy="#{prd.quantity}">
	                <h:outputText value="#{prd.quantity}" />
	              </p:column>
	       
	              <p:column headerText="Cod Barras" sortBy="#{prd.barcode}" >
	                <h:outputText value="#{prd.barcode}" />
	              </p:column>
         
                <p:column headerText="Opcoes" style="width:89px">
	                <p:commandLink
	                  action="#{manager.addProductCard(prd)}"
	                  update="@form"
	                  icon="ui-icon-check">
	                  <img src="resources/images/icons/check52.png" width="20" height="20" title="Adicionar Produto"/>
	                </p:commandLink>
	                
	                
                  <p:commandLink
                    onclick="PF('dlgListProducts').show();"
                    icon="ui-icon-check">
                    <img src="resources/images/icons/double126.png" width="20" height="20" title="Adicionar Produtos"/>
                    <f:setPropertyActionListener value="#{prd}" target="#{manager.selectedProductCash}"/>
                  </p:commandLink>
	                
	                
                </p:column>
	        
	          </p:dataTable>
	         </p:panelGrid>
            <br/>
            <h:commandButton styleClass="btn btn-primary" value="Fechar">
              <p:ajax event="click" process="@this dlgListProducts"  oncomplete="PF('dlgAddProduct').hide();" update="dtbCardCash"/>
            </h:commandButton>
        </p:dialog>
        
        
        
        <p:dialog id="dlgListProducts" header="Quantidade de Produtos" widgetVar="dlgListProducts" minHeight="40" resizable="false">
          <p:panelGrid id="pngQtdeProdCard"  columns="1" styleClass="panelgrid_sem_borda">
            <p:outputLabel value="Quantidade"/>
            <p:spinner value="#{manager.quantityProduct}"/>
            <h:commandButton styleClass="btn btn-primary" value="OK">
              <p:ajax event="click" process="@this dlgListProducts"  listener="#{manager.addListProductCard}" oncomplete="PF('dlgListProducts').hide();" update="@form"/>
            </h:commandButton>
          </p:panelGrid>
        </p:dialog>
        
         
         <p:dialog header="Produtos Comanda" widgetVar="dlgListProdCard" minHeight="40" resizable="false">
	         <p:panelGrid id="pngListProdCard"  columns="1" styleClass="panelgrid_sem_borda">
	           <p:commandButton value="Adicionar Produto"/>
	           
	           <p:dataTable id="dtbProductsCard"  var="prd" value="#{manager.selectedCardCash.listGroupProd}" emptyMessage="Nenhum Produto encontrado nesta Comanda" >
							   <f:facet name="header">
							       Produtos Comanda
							   </f:facet>
 
	               <p:column headerText="Cod Prod"/>
	        
	               <p:column headerText="Nome"/>
          
                 <p:column headerText="Quantidade"/>
	        
	               <p:column headerText="Unitário R$"/>
          
                 <p:column headerText="Total R$"/>
	               
	               <p:column headerText="Opções"/>
	               
	               <p:subTable var="item" value="#{prd.value}">
                   
                    <p:column>
                        <h:outputText value="#{item.product.id_product}"/>
                    </p:column> 
            
                    <p:column>
                        <h:outputText value="#{item.product.name}"/>
                    </p:column> 
            
                    <p:column>
                        <h:outputText value="#{item.quantity}"/>
                    </p:column> 
            
                    <p:column>
                        <h:outputText value="#{item.product.price}"/>
                    </p:column>
            
                    <p:column>
                        <h:outputText value="#{item.total}"/>
                    </p:column>
            
                    <p:column>
                       remover
                    </p:column>
            
                </p:subTable>

						   
	               
	           </p:dataTable>
	          </p:panelGrid>
	          
	        <br/>
	        <p:commandButton value="Fechar Comanda" oncomplete="PF('dlgListProdCard').hide();"/>
        </p:dialog>
        
        
         
         <p:dialog header="Fechamento da Comanda" widgetVar="dlgCloseCard" minHeight="40" resizable="false">
            <p:fieldset>
              <p:panelGrid id="pngCloseProdCard"  columns="1" styleClass="panelgrid_sem_borda">
                <p:dataTable id="dtbCloseProducts"  var="prd" value="#{manager.products}" editable="true" emptyMessage="Nenhum Produto encontrado" >
                       
                    <p:column headerText="Nome">
                      <h:outputText value="#{prd.name}" />
                    </p:column>
             
                    <p:column headerText="Preço">
                      <h:outputText value="#{prd.price}" />
                    </p:column>
             
                    <p:column headerText="Barcode">
                      <h:outputText value="#{prd.barcode}" />
                    </p:column>
                    
                    <p:column headerText="Selecionar">
                     <p:commandButton value="Selecionar" />
                    </p:column>
                    
                </p:dataTable>
              </p:panelGrid>
            </p:fieldset>
            <br/>
            <p:commandButton value="Incluir" oncomplete="PF('dlgCloseCard').hide();"/>
        </p:dialog>
         
       
     
         
          
        </ui:define>
    </ui:decorate>
</html>